<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Options page for exporting IUB Rec captures as PDF"
    />
    <title>IUB Options</title>
    <link rel="icon" type="image/png" sizes="16x16" href="../../assets/icon16.png" />
    <link rel="icon" type="image/png" sizes="48x48" href="../../assets/icon48.png" />
    <link rel="icon" type="image/png" sizes="128x128" href="../../assets/icon128.png" />
    <link rel="stylesheet" href="options.css" />
    <script src="shared.js"></script>
  </head>
  <body>
    <header class="title-wrapper" role="banner">
      <img src="../../assets/icon128.png" alt="IUB logo" aria-hidden="true" />
      <div>
        <h1>IUB</h1>
        <div class="title-lead">
          <span id="version" aria-live="polite"></span>
        </div>
      </div>
      <div
        style="margin-left: auto; display: flex; gap: 10px; align-items: center"
      >
        <button id="open-sidebar" class="action-button">üìÇ Open Sidebar</button>
        <button id="open-workspace" class="action-button">üè¢ Open Workspace</button>
        <button id="open-editor" class="action-button">‚úèÔ∏è Open Editor</button>
      </div>
      <style>
        .action-button {
          padding: 10px 20px;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          border: none;
          border-radius: 10px;
          cursor: pointer;
          font-weight: 600;
          font-size: 14px;
          transition: all 0.3s ease;
          box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        .action-button:hover {
          transform: translateY(-2px);
          box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
          background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }
        .action-button:active {
          transform: translateY(0);
          box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }
        .title-wrapper {
          display: flex;
          align-items: center;
          gap: 15px;
        }
      </style>
    </header>
    <hr />
    <main>
      <!-- Feature Info Cards -->
      <section style="margin-bottom: 30px;">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px;">
          <!-- Storage Usage Card -->
          <div style="
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
          ">
            <h3 style="margin: 0 0 10px 0; font-size: 18px;">üíæ Storage Bruk</h3>
            <div id="storage-info" style="font-size: 14px; opacity: 0.95;">
              <div style="margin-bottom: 8px;">
                <strong>Brukt:</strong> <span id="storage-used">Laster...</span>
              </div>
              <div style="margin-bottom: 8px;">
                <strong>Ledig:</strong> <span id="storage-free">Laster...</span>
              </div>
              <div style="background: rgba(255, 255, 255, 0.2); height: 8px; border-radius: 4px; overflow: hidden; margin-top: 10px;">
                <div id="storage-bar" style="background: white; height: 100%; width: 0%; transition: width 0.5s ease;"></div>
              </div>
              <div id="cloud-status-row" style="display:flex; align-items:center; gap:8px; margin-top: 16px; font-weight:600;">
                <span>‚òÅÔ∏è Sky-synk:</span>
                <span id="cloud-status-text" data-state="local">Lokal lagring</span>
              </div>
              <small id="cloud-status-hint" style="display:block; margin-top:4px; font-size:12px; opacity:0.85;">
                Konfigurer skysynk under for √• unng√• at lokal lagring blir full.
              </small>
              <button id="delete-all-sessions-btn" style="
                margin-top: 15px;
                padding: 8px 16px;
                background: rgba(255, 255, 255, 0.2);
                color: white;
                border: 2px solid white;
                border-radius: 8px;
                cursor: pointer;
                font-size: 13px;
                font-weight: 600;
                width: 100%;
                transition: all 0.3s ease;
              ">
                üóëÔ∏è Slett Alle Sessions
              </button>
            </div>
          </div>

          <!-- AI Features Card -->
          <div id="ai-status-card" style="
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
          ">
            <h3 style="margin: 0 0 10px 0; font-size: 18px;">ü§ñ AI-Funksjoner</h3>
            <div id="ai-status" style="font-size: 14px; opacity: 0.95;">
              <div style="margin-bottom: 8px;">
                <strong>Status:</strong> <span id="ai-status-text">Sjekker...</span>
              </div>
              <div style="font-size: 13px; margin-top: 10px;">
                Legg til OpenAI API-n√∏kkel nedenfor for AI-beskrivelser av screenshots
              </div>
            </div>
          </div>

          <!-- Click Indicator Card -->
          <div style="
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
          ">
            <h3 style="margin: 0 0 10px 0; font-size: 18px;">üéØ Klikk-Indikator</h3>
            <div style="font-size: 14px; opacity: 0.95;">
              <div style="margin-bottom: 8px;">
                Viser r√∏d sirkel p√• screenshots der du klikker
              </div>
              <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; margin-top: 10px;">
                <input type="checkbox" id="show-click-indicator-option" style="width: 20px; height: 20px; cursor: pointer;">
                <span>Aktiver klikk-indikator</span>
              </label>
            </div>
          </div>
        </div>
      </section>

      <section class="pdfcrowd-category" role="form">
        <h2 id="options-title" class="pdfcrowd-category-title">Options</h2>
        <form
          class="options"
          aria-labelledby="options-title"
          autocomplete="off"
          spellcheck="false"
        >
          <h3 style="margin: 12px 0 8px 0;">Sidepanel Settings</h3>
          <table role="presentation" style="margin-bottom: 16px;">
            <tr>
              <th scope="row">
                <label for="api_key">OpenAI API Key:</label>
              </th>
              <td>
                <input
                  type="password"
                  name="api_key"
                  id="api_key"
                  placeholder="sk-proj-..."
                  aria-label="Enter your OpenAI API key"
                  style="
                    width: 100%;
                    padding: 6px;
                    border: 1px solid #ccc;
                    border-radius: 4px;
                  "
                />
                <small style="display: block; margin-top: 4px; color: #666"
                  >Required for AI-powered features in sidepanel. Get your key from
                  <a href="https://platform.openai.com/api-keys" target="_blank"
                    >OpenAI</a
                  ></small
                >
              </td>
            </tr>
            <tr>
              <th scope="row">
                <label for="capture_mode">Capture mode:</label>
              </th>
              <td>
                <select
                  name="capture_mode"
                  id="capture_mode"
                  aria-label="Select capture mode"
                >
                  <option value="full">Full screen</option>
                  <option value="click">Area around click</option>
                </select>
              </td>
            </tr>
          </table>

          <h3 style="margin: 24px 0 8px 0;">Sky-lagring</h3>
          <table role="presentation">
            <tr>
              <th scope="row">
                <label for="storage_provider">Synk til:</label>
              </th>
              <td>
                <select name="storage_provider" id="storage_provider" aria-label="Velg skylagring">
                  <option value="local">Kun lokal lagring (standard)</option>
                  <option value="dropbox">Dropbox</option>
                  <option value="onedrive">Microsoft OneDrive</option>
                  <option value="gdrive">Google Drive</option>
                </select>
                <small style="display:block; margin-top:4px; color:#555;">
                  Velg hvor sessions skal sikkerhetskopieres. Tokens lagres kun lokalt p√• maskinen din.
                </small>
              </td>
            </tr>
            <tr class="cloud-field" data-provider="dropbox,onedrive,gdrive">
              <th scope="row">
                <label for="cloud_file_name">Filnavn:</label>
              </th>
              <td>
                <input
                  type="text"
                  id="cloud_file_name"
                  name="cloud_file_name"
                  placeholder="iub-recorder-sessions.json"
                />
                <small style="display:block; margin-top:4px; color:#555;">
                  JSON-fil som inneholder alle sessions. Opprettes automatisk hvis den ikke finnes.
                </small>
              </td>
            </tr>
            <tr class="cloud-field" data-provider="dropbox">
              <th scope="row">
                <label for="dropbox_token">Dropbox access token:</label>
              </th>
              <td>
                <input type="password" id="dropbox_token" autocomplete="off" placeholder="sl.BC..." />
                <small style="display:block; margin-top:4px; color:#555;">Generer et "App access token" fra Dropbox App Console.</small>
              </td>
            </tr>
            <tr class="cloud-field" data-provider="dropbox">
              <th scope="row">
                <label for="dropbox_path">Dropbox mappe:</label>
              </th>
              <td>
                <input type="text" id="dropbox_path" placeholder="/Apps/IUB-Recorder" />
              </td>
            </tr>
            <tr class="cloud-field" data-provider="onedrive">
              <th scope="row">
                <label for="onedrive_token">OneDrive access token:</label>
              </th>
              <td>
                <input type="password" id="onedrive_token" autocomplete="off" placeholder="EwB4A..." />
                <small style="display:block; margin-top:4px; color:#555;">Bruk Microsoft Graph token med skrive-tilgang til OneDrive.</small>
              </td>
            </tr>
            <tr class="cloud-field" data-provider="onedrive">
              <th scope="row">
                <label for="onedrive_path">OneDrive sti:</label>
              </th>
              <td>
                <input type="text" id="onedrive_path" placeholder="/Documents/IUB-Recorder" />
              </td>
            </tr>
            <tr class="cloud-field" data-provider="gdrive">
              <th scope="row">
                <label for="gdrive_token">Google Drive token:</label>
              </th>
              <td>
                <input type="password" id="gdrive_token" autocomplete="off" placeholder="ya29.a0..." />
                <small style="display:block; margin-top:4px; color:#555;">Bruk OAuth 2.0 access token med Drive API scope.</small>
              </td>
            </tr>
            <tr class="cloud-field" data-provider="gdrive">
              <th scope="row">
                <label for="gdrive_folder_id">Google Drive mappe-ID:</label>
              </th>
              <td>
                <input type="text" id="gdrive_folder_id" placeholder="(valgfritt)" />
                <small style="display:block; margin-top:4px; color:#555;">La st√• tom for √• lagre i rot. Bruk ID fra Drive-URL.</small>
              </td>
            </tr>
            <tr class="cloud-field" data-provider="gdrive">
              <th scope="row">
                <label for="gdrive_file_id">Eksisterende fil-ID:</label>
              </th>
              <td>
                <input type="text" id="gdrive_file_id" placeholder="(valgfritt)" />
                <small style="display:block; margin-top:4px; color:#555;">Om du allerede har en fil, lim inn ID her. Ellers opprettes ny.</small>
              </td>
            </tr>
          </table>

          <h3 style="margin: 12px 0 8px 0;">AI Chat PDF Export</h3>
          <table role="presentation">
            <tr>
              <th scope="row">
                <label for="theme">Color theme:</label>
              </th>
              <td>
                <select name="theme" id="theme" aria-label="Select color theme">
                  <option value="">Auto</option>
                  <option value="light">Light</option>
                  <option value="dark">Dark</option>
                </select>
              </td>
            </tr>
            <tr>
              <th scope="row">
                <label for="no_questions">Exclude user inputs:</label>
              </th>
              <td>
                <input
                  type="checkbox"
                  id="no_questions"
                  name="no_questions"
                  aria-label="Exclude user inputs from PDF"
                />
              </td>
            </tr>
            <tr>
              <th scope="row">
                <label for="no_icons">Exclude icons:</label>
              </th>
              <td>
                <input
                  type="checkbox"
                  id="no_icons"
                  name="no_icons"
                  aria-label="Exclude icons from PDF"
                />
              </td>
            </tr>
            <tr>
              <th scope="row">
                <label for="zoom">Font size (30-300%):</label>
              </th>
              <td>
                <input
                  name="zoom"
                  id="zoom"
                  type="number"
                  step="1"
                  min="10"
                  max="300"
                  aria-label="Set font size percentage"
                />
              </td>
            </tr>
            <tr>
              <th scope="row">
                <label for="margins">Page margins:</label>
              </th>
              <td>
                <select
                  name="margins"
                  id="margins"
                  aria-label="Select page margins"
                >
                  <option value="">Default</option>
                  <option value="minimal">Minimal</option>
                  <option value="custom">Custom</option>
                </select>
              </td>
            </tr>
            <tr class="sub-option sub-margin">
              <th scope="row">
                <label for="margin_top">Top margin:</label>
              </th>
              <td>
                <input
                  type="text"
                  name="margin_top"
                  id="margin_top"
                  aria-label="Specify top margin (e.g., 0, 10px, 2cm)"
                  title="Accepted units: in, px, cm, mm, pt"
                  pattern="((\d+(\.\d*)?)|((\d*\.)?\d+))\s*(in|cm|mm|px|pt|)"
                />
              </td>
            </tr>
            <tr class="sub-option sub-margin">
              <th scope="row">
                <label for="margin_bottom">Bottom margin:</label>
              </th>
              <td>
                <input
                  type="text"
                  name="margin_bottom"
                  id="margin_bottom"
                  aria-label="Specify bottom margin (e.g., 0, 10px, 2cm)"
                  title="Accepted units: in, px, cm, mm, pt"
                  pattern="((\d+(\.\d*)?)|((\d*\.)?\d+))\s*(in|cm|mm|px|pt|)"
                />
              </td>
            </tr>
            <tr class="sub-option sub-margin">
              <th scope="row">
                <label for="margin_left">Left margin:</label>
              </th>
              <td>
                <input
                  type="text"
                  name="margin_left"
                  id="margin_left"
                  aria-label="Specify left margin (e.g., 0, 10px, 2cm)"
                  title="Accepted units: in, px, cm, mm, pt"
                  pattern="((\d+(\.\d*)?)|((\d*\.)?\d+))\s*(in|cm|mm|px|pt|)"
                />
              </td>
            </tr>
            <tr class="sub-option sub-margin">
              <th scope="row">
                <label for="margin_right">Right margin:</label>
              </th>
              <td>
                <input
                  type="text"
                  name="margin_right"
                  id="margin_right"
                  aria-label="Specify right margin (e.g., 0, 10px, 2cm)"
                  title="Accepted units: in, px, cm, mm, pt"
                  pattern="((\d+(\.\d*)?)|((\d*\.)?\d+))\s*(in|cm|mm|px|pt|)"
                />
              </td>
            </tr>
            <tr>
              <th scope="row">
                <label for="title_mode">PDF Title:</label>
              </th>
              <td>
                <select
                  name="title_mode"
                  id="title_mode"
                  aria-label="Set PDF title"
                >
                  <option value="">Capture title</option>
                  <option value="ask">Ask</option>
                  <option value="none">None</option>
                </select>
              </td>
            </tr>
            <tr>
              <th scope="row">
                <label for="q_color">User input background color:</label>
              </th>
              <td>
                <select
                  id="q_color"
                  name="q_color"
                  aria-label="Choose user input background color"
                >
                  <option value="default">Default</option>
                  <option value="none">None</option>
                  <option value="custom">Custom</option>
                </select>
              </td>
            </tr>
            <tr id="q_color_picker_row" class="sub-option">
              <th scope="row">
                <label for="q_color_picker">Choose color:</label>
              </th>
              <td>
                <input
                  id="q_color_picker"
                  type="color"
                  name="q_color_picker"
                  aria-label="Pick custom user input background color"
                />
              </td>
            </tr>
            <tr>
              <th scope="row">
                <label for="q_fg_color">User input text color:</label>
              </th>
              <td>
                <select
                  id="q_fg_color"
                  name="q_fg_color"
                  aria-label="Choose user input text color"
                >
                  <option value="default">Default</option>
                  <option value="custom">Custom</option>
                </select>
              </td>
            </tr>
            <tr id="q_fg_color_picker_row" class="sub-option">
              <th scope="row">
                <label for="q_fg_color_picker">Choose color:</label>
              </th>
              <td>
                <input
                  id="q_fg_color_picker"
                  type="color"
                  name="q_fg_color_picker"
                  aria-label="Pick custom user input text color"
                />
              </td>
            </tr>
            <tr>
              <th scope="row">
                <label for="page_break">Page breaks:</label>
              </th>
              <td>
                <select
                  name="page_break"
                  id="page_break"
                  aria-label="Select page break behavior"
                >
                  <option value="">Auto</option>
                  <option value="after">After each capture</option>
                </select>
              </td>
            </tr>
            <tr>
              <th scope="row">
                <label for="toc">Table of contents:</label>
              </th>
              <td>
                <div class="flex-center">
                  <select
                    name="toc"
                    id="toc"
                    aria-label="Choose the presence of a table of contents"
                  >
                    <option value="">None</option>
                    <option value="basic">Standard</option>
                    <option value="numbering">Numbered</option>
                  </select>
                  <div class="toc-note">
                    (The table of contents will be generated from capture
                    titles)
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <th scope="row">
                <label for="model_name">Include AI model info:</label>
              </th>
              <td>
                <input
                  type="checkbox"
                  id="model_name"
                  name="model_name"
                  aria-label="Include AI commentary model info in PDF"
                />
              </td>
            </tr>
          </table>
          <div class="mb-3"></div>
          <div>
            <button
              id="save"
              class="save mt-3 mr-2"
              aria-label="Apply changes to export options"
            >
              Apply Changes
            </button>
            <button
              id="reset"
              class="mt-3"
              aria-label="Reset export options to default"
            >
              Reset
            </button>
            <span id="status" style="display: none" aria-live="assertive">
              Saved
            </span>
          </div>
        </form>
      </section>
      <footer style="line-height: 1.5; margin-top: 2em">
        <p>
          For support with IUB, contact us at
          <strong>support@iub-rec.com</strong> or visit our
          <a
            href="https://iub-rec.com/contact"
            title="Contact us"
            target="_blank"
          >
            contact page</a
          >.
        </p>
      </footer>
    </main>
    <script type="module" src="options-i18n.js"></script>
    <script type="module" src="options.js"></script>
  </body>
</html>
